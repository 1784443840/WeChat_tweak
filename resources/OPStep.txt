
- Remove arch
lipo libsubstrate.dylib -remove armv6 -output ./libsubstrate.dylib
lipo -info libsubstrate.dylib

- Compile dynamic library
cd /Users/dyfei/Desktop/XApleSysCalcService
make
open .theos/obj/debug/


- Change path
otool -L XApleSysCalcService
install_name_tool -change /Library/Frameworks/CydiaSubstrate.framework/CydiaSubstrate @loader_path/XApleSysSubstr XApleSysCalcService 


- Write executable path
 /Users/dyfei/UWork/DevMgr/WeChatExtensionFunction/hook-tools/optool install -c load -p "@executable_path/XApleSysCalcService" -t ./WeChat


- Modify Info.plist of WeChat and Localized file


- Modify bundle id and the prefix is the same as WeChat, resign
codesign -f -s "iPhone Distribution: Wang Ye (5WQHRCQ7JQ)" Payload/WeChat.app/PlugIns/WeChatShareExtensionNew.appex
codesign -f -s "iPhone Distribution: Wang Ye (5WQHRCQ7JQ)" Payload/WeChat.app/PlugIns/WeChatSiriExtension.appex
codesign -f -s "iPhone Distribution: Wang Ye (5WQHRCQ7JQ)" Payload/WeChat.app/PlugIns/WeChatSiriExtensionUI.appex


- Resign dynamic library
codesign -f -s "iPhone Distribution: Wang Ye (5WQHRCQ7JQ)" Payload/WeChat.app/XApleSysCalcService 
codesign -f -s "iPhone Distribution: Wang Ye (5WQHRCQ7JQ)" Payload/WeChat.app/XApleSysSubstr
codesign -f -s "iPhone Distribution: Wang Ye (5WQHRCQ7JQ)" Payload/WeChat.app/Frameworks/mars.framework
codesign -f -s "iPhone Distribution: Wang Ye (5WQHRCQ7JQ)" Payload/WeChat.app/Frameworks/MMCommon.framework
codesign -f -s "iPhone Distribution: Wang Ye (5WQHRCQ7JQ)" Payload/WeChat.app/Frameworks/WCDB.framework
codesign -f -s "iPhone Distribution: Wang Ye (5WQHRCQ7JQ)" Payload/WeChat.app/Frameworks/MultiMedia.framework


- Resign app
./Doc/xccodesign.sh /Users/dyfei/Desktop/Payload "iPhone Distribution: Wang Ye (5WQHRCQ7JQ)" /Users/dyfei/Desktop/iosdevprovadhoc.mobileprovision


- Package app for Xcode7
xcrun -sdk iphoneos PackageApplication -v Payload/WeChat.app -o ~/Desktop/wc2.ipa


